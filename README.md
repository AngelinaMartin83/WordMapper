# WordMapper (Next.js + Vercel å®‰å…¨ç‰ˆ)

ä¸€ä¸ªåŸºäº **Next.js 14 App Router** æ¶æ„çš„åœ¨çº¿å•è¯éŸ³æ ‡å¯¹é½å·¥å…·ã€‚  
å‰ç«¯ç•Œé¢å®Œå…¨é™æ€ã€å¿«é€ŸåŠ è½½ï¼›  
å­—å…¸å’Œå¯¹é½é€»è¾‘å…¨éƒ¨åœ¨ **æœåŠ¡ç«¯æ‰§è¡Œ**ï¼Œä¿è¯æ•°æ®å®‰å…¨ï¼Œç”¨æˆ·æ— æ³•çœ‹åˆ° JSON æ–‡ä»¶å†…å®¹ã€‚

---

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- âœ… **å‰ç«¯çº¯é™æ€**ï¼ˆHTML + JS + CSSï¼‰  
- ğŸ”’ **å­—å…¸ä»…å­˜æ”¾åœ¨æœåŠ¡å™¨ï¼Œä¸æš´éœ²å‰ç«¯**  
- ğŸª **è‡ªåŠ¨ç”Ÿæˆå®‰å…¨ httpOnly ä¼šè¯ Cookie**ï¼ˆæ— éœ€ç”¨æˆ·ç™»å½•æˆ– Tokenï¼‰  
- âš¡ **Edge Middleware è‡ªåŠ¨ä¸‹å‘ Cookie**  
- ğŸ§  **æœåŠ¡ç«¯åŠ¨æ€åŠ è½½å­—å…¸ & å¼ºåˆ¶å¯¹é½è®¡ç®—**  
- ğŸ§© **çº¯ JS å‰ç«¯äº¤äº’ï¼Œä¸åŸé¡µé¢å¤–è§‚ä¸€è‡´**  
- ğŸŒ **å¯ä¸€é”®éƒ¨ç½²åˆ° Vercel å…è´¹æ–¹æ¡ˆ**

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.js              # å…¨å±€å¸ƒå±€ï¼ˆå¼•å…¥ CSS ä¸ JSï¼‰
â”‚   â”œâ”€â”€ page.js                # é¡µé¢ä¸»ç»“æ„ï¼ˆHTML å†…å®¹ï¼‰
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ align/route.js     # åç«¯æ¥å£ï¼šå¯¹é½é€»è¾‘ + é‰´æƒ
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.js                # Node.js ä¼šè¯éªŒè¯ï¼ˆHMAC ç­¾åï¼‰
â”‚   â”œâ”€â”€ edgeAuth.js            # Edge ç¯å¢ƒç­¾åï¼ˆmiddleware ç”¨ï¼‰
â”‚   â””â”€â”€ aligner.js             # å¼ºåˆ¶å¯¹é½ç®—æ³•ï¼ˆDP åŠ¨æ€è§„åˆ’å®ç°ï¼‰
â”‚
â”œâ”€â”€ middleware.js              # Edge Middlewareï¼šè‡ªåŠ¨è®¾ç½® Cookie
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/style.css          # é¡µé¢æ ·å¼
â”‚   â”œâ”€â”€ js/app.js              # å‰ç«¯é€»è¾‘ï¼ˆfetch API/æ¸²æŸ“ï¼‰
â”‚   â””â”€â”€ favicon.ico            # å›¾æ ‡
â”‚
â”œâ”€â”€ server-data/
â”‚   â””â”€â”€ beep_uk_ipa.json       # ğŸ”’ å­—å…¸æ•°æ®ï¼ˆæœåŠ¡ç«¯ä¸“ç”¨ï¼‰
â”‚
â”œâ”€â”€ package.json               # é¡¹ç›®ä¾èµ–ä¸è„šæœ¬
â”œâ”€â”€ next.config.js             # Next.js é…ç½®
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹ï¼ˆéœ€å¤åˆ¶ä¸º .env.localï¼‰
â””â”€â”€ README.md
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡è®¾ç½®

1ï¸âƒ£ æœ¬åœ°å¼€å‘ï¼š
```bash
cp .env.example .env.local
```
ç¼–è¾‘ `.env.local`ï¼š
```bash
AUTH_TOKEN=éšæ„å¼ºéšæœºå­—ç¬¦ä¸²
```

2ï¸âƒ£ éƒ¨ç½²åˆ° Vercelï¼š
åœ¨é¡¹ç›®çš„  
**Settings â†’ Environment Variables** ä¸­æ·»åŠ åŒåå˜é‡ï¼š
```
AUTH_TOKEN=ï¼ˆåŒæ ·çš„å¼ºéšæœºå­—ç¬¦ä¸²ï¼‰
```

---

## ğŸ§© å·¥ä½œæµç¨‹

1. ç”¨æˆ·è®¿é—®é¦–é¡µ â†’ `middleware.js` è‡ªåŠ¨ç”Ÿæˆå®‰å…¨ Cookie (`sid`)  
2. å‰ç«¯è¾“å…¥å•è¯ â†’ `public/js/app.js` è°ƒç”¨ `/api/align`  
3. æ¥å£éªŒè¯ Cookie â†’ ä» `server-data/beep_uk_ipa.json` è¯»å– IPA  
4. ä½¿ç”¨ `lib/aligner.js` æ‰§è¡Œå¯¹é½ç®—æ³•  
5. è¿”å›ç»“æœç»™å‰ç«¯æ¸²æŸ“ï¼Œæ— ä»»ä½•å­—å…¸æ•°æ®æš´éœ²

---

## ğŸ§ª æœ¬åœ°è¿è¡Œ

```bash
npm install
npm run dev
```

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š  
ğŸ‘‰ http://localhost:3000

---

## ğŸš€ éƒ¨ç½²åˆ° Vercel

1. å°†é¡¹ç›®ä¸Šä¼ åˆ° GitHub  
2. ç™»å½• [Vercel](https://vercel.com)  
3. **Import Project â†’ é€‰æ‹© GitHub ä»“åº“ â†’ éƒ¨ç½²**  
4. åœ¨ Vercel é¡¹ç›® **Settings â†’ Environment Variables** ä¸­æ·»åŠ ï¼š
   ```
   AUTH_TOKEN=ä½ çš„éšæœºå­—ç¬¦ä¸²
   ```
5. éƒ¨ç½²å®Œæˆåï¼Œç›´æ¥è®¿é—®å³å¯ä½¿ç”¨ï¼Œæ— éœ€ç™»å½•ã€‚

---

## ğŸ” å®‰å…¨è®¾è®¡è¯´æ˜

| å®‰å…¨ç‚¹ | è¯´æ˜ |
|--------|------|
| å­—å…¸ä¿æŠ¤ | `beep_uk_ipa.json` å­˜äº `server-data/`ï¼Œä¸ä¼šè¢«æ‰“åŒ…åˆ°å‰ç«¯ |
| Cookie é‰´æƒ | ç”± Edge Middleware è‡ªåŠ¨ç”Ÿæˆã€HttpOnlyã€7å¤©æœ‰æ•ˆ |
| API é™åˆ¶ | `/api/align` å¿…é¡»å¸¦æœ‰æ•ˆ Cookieï¼ˆæˆ– Bearer Token æ‰æ”¾è¡Œï¼‰ |
| æ— æš´éœ² Token | å‰ç«¯æ— ä»»ä½•æ•æ„Ÿä¿¡æ¯æˆ–ç¯å¢ƒå˜é‡ |
| CDN ç¼“å­˜å®‰å…¨ | Middleware é»˜è®¤ç¦ç”¨é¡µé¢ç¼“å­˜ï¼Œç¡®ä¿ Cookie ä¸‹å‘å¯é  |

---

## ğŸ§¹ ç»´æŠ¤å»ºè®®

- **ä¸å†ä½¿ç”¨ `index.html`**ï¼ˆè¯¥æ–‡ä»¶å·²å¼ƒç”¨ï¼ŒNext.js ç”¨ `app/page.js` æ¸²æŸ“ï¼‰
- æ›´æ–°å­—å…¸æ—¶åªéœ€æ›¿æ¢ `server-data/beep_uk_ipa.json`ï¼Œæ— éœ€æ”¹ä»£ç   
- è‹¥å‡ºç° 401ï¼Œå¯æ£€æŸ¥ï¼š
  - Cookie æ˜¯å¦è¢«ç¦ç”¨ï¼›
  - Vercel `AUTH_TOKEN` æ˜¯å¦ä¸ `.env.local` ä¸€è‡´ã€‚

---

## ğŸ“„ è®¸å¯è¯

MIT License  
Â© 2025 WordMapper Project
